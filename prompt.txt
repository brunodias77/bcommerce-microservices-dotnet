ğŸ›’ **B-Commerce (.NET Edition): Design EstratÃ©gico e Roadmap de Desenvolvimento com MicrosserviÃ§os em C#**

---

### ğŸ¯ OBJETIVO PRINCIPAL

Desenvolver uma plataforma de e-commerce moderna, escalÃ¡vel e resiliente, utilizando C# e .NET 8 com arquitetura de microsserviÃ§os desacoplada, autenticaÃ§Ã£o centralizada via Keycloak (OIDC) e infraestrutura preparada para produÃ§Ã£o desde o inÃ­cio.

---

### ğŸ“¦ CONTEXTO E VISÃƒO DO PRODUTO

O **B-Commerce** Ã© um e-commerce especializado em produtos eletrÃ´nicos e de alta tecnologia, com foco em UX fluida, alta performance e checkout simplificado.

**PÃºblico-alvo:** consumidores tech exigentes que valorizam agilidade e clareza nas informaÃ§Ãµes de produto.

---

### ğŸ§± PRINCÃPIOS DE ARQUITETURA

- **DomÃ­nios Independentes**: Cada serviÃ§o representa um *bounded context* do negÃ³cio.
- **ComunicaÃ§Ã£o AssÃ­ncrona**: RabbitMQ como padrÃ£o, REST apenas quando necessÃ¡rio.
- **Arquitetura Limpa (Clean Architecture)**: NÃºcleo de domÃ­nio isolado, com separaÃ§Ã£o clara entre camadas de aplicaÃ§Ã£o, domÃ­nio e infraestrutura.
- **SeguranÃ§a Centralizada**: Keycloak (OIDC) para autenticaÃ§Ã£o e autorizaÃ§Ã£o.
- **Infraestrutura como CÃ³digo (IaC)**: Inicialmente com Docker Compose, evoluÃ§Ã£o futura para Kubernetes.

---

### ğŸ› ï¸ STACK TECNOLÃ“GICA (.NET Edition)

| Camada | Tecnologias |
| --- | --- |
| **Backend** | .NET 8, ASP.NET Core (Minimal APIs), Entity Framework Core, MassTransit |
| **Frontend** | Angular 20, TailwindCSS, RxJS, OIDC Client, Signals, Standalone Components |
| **Banco** | PostgreSQL (relacional), MongoDB (cart/sessÃ£o â€“ pÃ³s-MVP) |
| **Mensageria** | RabbitMQ, MassTransit (com integraÃ§Ã£o nativa no .NET) |
| **Identidade** | Keycloak (OIDC) |
| **Deploy & Infra** | Docker, Docker Compose, (futuramente Kubernetes) |
| **Testes** | xUnit, Moq, Testcontainers (.NET), FluentAssertions |
| **Gateway** | YARP (Yet Another Reverse Proxy) + DelegatingHandlers + Polly |

---

### ğŸ§­ ROADMAP DE DESENVOLVIMENTO

---

### ğŸ§© FASE 1: Infraestrutura (`infra-service`)

ğŸ”§ **Provisionamento via Docker Compose**:

- Keycloak com realm `b-commerce-realm`, clients `frontend` e `backend`.
- RabbitMQ com exchanges e filas padrÃ£o.
- PostgreSQL com volumes persistentes.

âœ… **Aceite:** ServiÃ§os acessÃ­veis, login no Keycloak e RabbitMQ funcionando.

---

### ğŸ‘¤ FASE 2: Client Service

- CRUD completo de usuÃ¡rios
- IntegraÃ§Ã£o com Keycloak (JWT Claims)
- Gerenciamento de endereÃ§os e consentimento LGPD

ğŸ§ª **Stack**:

.NET 8, ASP.NET Core, EF Core, FluentValidation, MassTransit, PostgreSQL, **Clean Architecture**, xUnit, Testcontainers

âœ… **Aceite:** Endpoints REST, tokens JWT validados, testes cobrindo >80%.

---

### ğŸ“¦ FASE 3: Catalog Service

- CRUD de produtos e categorias
- API de busca
- PublicaÃ§Ã£o de eventos (`product.stock.changed`)

ğŸ§ª **Stack**:

.NET 8, EF Core, MassTransit, RabbitMQ, PostgreSQL, Testcontainers

âœ… **Aceite:** Estrutura robusta e eventos rastreÃ¡veis no broker.

---

### ğŸŒ FASE 4: API Gateway

- Roteamento com YARP
- Middleware JWT + OIDC
- Circuit Breaker e Retry com Polly
- Logging e CORS centralizados

ğŸ§ª **Stack**:

YARP, Polly, Serilog, ASP.NET Core Authentication OIDC

âœ… **Aceite:** Gateway funcionando, frontend interage sÃ³ por ele.

---

### ğŸ›’ FASE 5: Cart Service

- CRUD de itens no carrinho
- CÃ¡lculo de totais

ğŸ§ª **Stack**:

.NET 8, MongoDB (Document Store), **Clean Architecture**, xUnit

âœ… **Aceite:** CÃ¡lculos corretos, endpoints protegidos via OIDC.

---

### ğŸ’³ FASE 6: Sales Service

- FinalizaÃ§Ã£o de pedidos
- ValidaÃ§Ã£o de estoque e preÃ§o via eventos
- Mock de pagamento
- PublicaÃ§Ã£o de status de pedido

ğŸ§ª **Stack**:

.NET 8, MassTransit, RabbitMQ, PostgreSQL, **Clean Architecture**

âœ… **Aceite:** Pedidos vÃ¡lidos, integraÃ§Ã£o por eventos funcionando.

---

### ğŸ–¥ï¸ FASE 7: Frontend (Angular 20)

- AutenticaÃ§Ã£o com OIDC
- Listagem de produtos
- Carrinho e checkout
- Tela de pedidos do usuÃ¡rio

ğŸ§ª **Stack**:

Angular 20, Standalone Components, Signals, TailwindCSS, Zod, OIDC Client

âœ… **Aceite:** NavegaÃ§Ã£o fluida, integraÃ§Ã£o total, validaÃ§Ãµes robustas.

---

### ğŸš€ PÃ“S-MVP: Futuro

### ğŸ”­ Observabilidade

OpenTelemetry, Prometheus, Grafana, Loki, Tempo, Dotnet Metrics

### ğŸ—ï¸ Arquitetura

- Banco separado por serviÃ§o (PostgreSQL/Mongo)
- Kubernetes, Service Mesh
- Elasticsearch/OpenSearch

---

### ğŸ“Œ REQUISITOS NÃƒO FUNCIONAIS (NFRs)

| Item | Meta |
| --- | --- |
| **Performance** | APIs com p95 < 200ms, LCP < 2.5s no frontend |
| **Escalabilidade** | MicrosserviÃ§os com escalonamento horizontal |
| **SeguranÃ§a** | OWASP Top 10, HTTPS obrigatÃ³rio, nada de secrets no cÃ³digo |
| **Confiabilidade** | SLA â‰¥ 99.9%, isolamento de falhas entre serviÃ§os |

---

### ğŸ§ª ENGENHARIA E DEVOPS

- **Git Flow:** `features` â†’ `develop` â†’ `main`
- **CI/CD:** GitHub Actions/GitLab CI com build, test, lint e deploy
- **Qualidade:** AnÃ¡lise estÃ¡tica com SonarQube + revisÃµes obrigatÃ³rias